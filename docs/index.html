<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="A workflow of (a) meta-clustering based on 
    inter-group similarity measures and (b) a ground-truth-free test metric to 
    assess the biological correctness of integration in real datasets. See Hu Z,
    Ahmed A, Yau C (2021) &lt;doi:10.1101/2021.03.29.437525&gt; for
    more details.">
<title>Meta-Clustering for Single-Cell Data Integration and Evaluation â€¢ CIDER</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Meta-Clustering for Single-Cell Data Integration and Evaluation">
<meta property="og:description" content="A workflow of (a) meta-clustering based on 
    inter-group similarity measures and (b) a ground-truth-free test metric to 
    assess the biological correctness of integration in real datasets. See Hu Z,
    Ahmed A, Yau C (2021) &lt;doi:10.1101/2021.03.29.437525&gt; for
    more details.">
<meta property="og:image" content="http://zhiyhu.github.io/CIDER/reference/figures/card.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-207749729-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-207749729-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">CIDER</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/asCIDER.html">Getting Start with Assisted CIDER (asCIDER)</a>
    <a class="dropdown-item" href="articles/dnCIDER.html">Detailed walk-through of de novo CIDER (dnCIDER) on pancreas data</a>
    <a class="dropdown-item" href="articles/dnCIDER_highlevel.html">Getting Start with De Novo CIDER (dnCIDER)</a>
    <a class="dropdown-item" href="articles/evaluation.html">Evaluating integration results by CIDER</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/zhiyhu/CIDER/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="cider-meta-clustering-for-single-cell-data-integration-and-evaluation">CIDER: Meta-Clustering for Single-Cell Data Integration and Evaluation<a class="anchor" aria-label="anchor" href="#cider-meta-clustering-for-single-cell-data-integration-and-evaluation"></a>
</h1>
</div>
<!-- badges: start --><!-- badges: end -->
<p>Clustering Single-cell RNA-Seq (scRNA-Seq) data from multiple samples or conditions are often challenged by confounding factors, such as batch effects and biologically relevant variability. Existing batch effect removal methods typically require strong assumptions on the composition of cell populations being near identical across samples. Here we present <strong>CIDER</strong>, a <strong>meta-clustering workflow</strong> based on inter-group similarity measures. The prototype of this method is firstly applied in <a href="https://www.sciencedirect.com/science/article/pii/S1535610820300428" class="external-link">Hu et al., Cancer Cell 2020</a>.</p>
<p><strong>For more informtion please see our <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-021-02561-2" class="external-link">publication</a> on Genome Biology (2021).</strong></p>
<p>CIDER can:</p>
<ol style="list-style-type: decimal">
<li>address the <strong>clustering</strong> task for confounded scRNA-Seq data, or</li>
<li>assess the biological correctness of integration as <strong>a test metric</strong>, while it does <strong>not</strong> require the existence of prior cellular annotations, or</li>
<li>compute the similarity among biological populations.</li>
</ol>
<div class="section level2">
<h2 id="installation-archived-versions">Installation (archived versions)<a class="anchor" aria-label="anchor" href="#installation-archived-versions"></a>
</h2>
<p>Archived versions of CIDER are available on <a href="https://cran.r-project.org/src/contrib/Archive/CIDER/" class="external-link">cran Archive</a>.</p>
<p>First you can download the package to a local folder and then install it from the file</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## replace the "path_to_pkg" with the real path</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"path_to_pkg/CIDER_0.99.1.tar.gz"</span>, repos <span class="op">=</span> <span class="cn">NULL</span>, type <span class="op">=</span> <span class="st">"source"</span><span class="op">)</span></code></pre></div>
<p>We are working on the compatibility to bring our package back to cran.</p>
</div>
<div class="section level2">
<h2 id="compatibility">Compatibility<a class="anchor" aria-label="anchor" href="#compatibility"></a>
</h2>
<p><strong>Seurat</strong>: currently our package only supports the old version Seurat objects, but not the Seurat v5. We are working to resolve the issue.</p>
</div>
<div class="section level2">
<h2 id="cider-as-an-evaluation-metric---quick-start">CIDER as an evaluation metric - Quick start<a class="anchor" aria-label="anchor" href="#cider-as-an-evaluation-metric---quick-start"></a>
</h2>
<p>If you have scRNA-Seq data corrected by an integration algorithm (e.g.Â Seurat-CCA, Harmony, Scanramaâ€¦). You can use CIDER to evaluate if the biological populations are correctly aligned.</p>
<p>Before running CIDER evaluation functions, make sure that you have a Seurat object (e.g.Â <code>seu.integrated</code>) with corrected PCs in <code>seu.integrated@reductions$pca@cell.embeddings</code>. Seurat-CCA automatically put the corrected PCs there. If other methods are used, the corrected PCs can be added using <code>seu.integrated@reductions$pca@cell.embeddings &lt;- corrected.PCs</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zhiyhu/CIDER" class="external-link">CIDER</a></span><span class="op">)</span>
<span class="va">seu.integrated</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hdbscan.seurat.html">hdbscan.seurat</a></span><span class="op">(</span><span class="va">seu.integrated</span><span class="op">)</span>
<span class="va">ider</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/getIDEr.html">getIDEr</a></span><span class="op">(</span><span class="va">seu.integrated</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">seu.integrated</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimateProb.html">estimateProb</a></span><span class="op">(</span><span class="va">seu.integrated</span>, <span class="va">ider</span><span class="op">)</span></code></pre></div>
<p>The evaluation scores (IDER-based similarity and empirical p values) can be visualised by the <code>scatterPlot</code> function. A <a href="https://zhiyhu.github.io/CIDER/articles/evaluation.html" class="external-link">detailed tutorial of evaluation</a> is available.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/scatterPlot.html">scatterPlot</a></span><span class="op">(</span><span class="va">seu.integrated</span>, <span class="st">"tsne"</span>, colour.by <span class="op">=</span> <span class="st">"similarity"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/scatterPlot.html">scatterPlot</a></span><span class="op">(</span><span class="va">seu.integrated</span>, <span class="st">"tsne"</span>, colour.by <span class="op">=</span> <span class="st">"pvalue"</span><span class="op">)</span> 
<span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1</span>,<span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/evaluation_scatterplot.png"></p>
</div>
<div class="section level2">
<h2 id="use-cider-for-clustering-tasks">Use CIDER for clustering tasks<a class="anchor" aria-label="anchor" href="#use-cider-for-clustering-tasks"></a>
</h2>
<!--- ![](man/figures/clustering_diagram.png)---><div class="section level3">
<h3 id="quick-start---ascider">Quick start - asCIDER<a class="anchor" aria-label="anchor" href="#quick-start---ascider"></a>
</h3>
<p>Here <code>seu</code> is a Seurat object with initial clustering annotation stored in <code>initial_cluster</code> of metadata and batch information in <code>Batch</code>. The asCIDER example here contains two steps: computing IDER-based similarity matrix (<code>getIDER</code>) and performing the final clustering (<code>finalClustering</code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ider</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/getIDEr.html">getIDEr</a></span><span class="op">(</span><span class="va">seu</span>, 
                group.by.var <span class="op">=</span> <span class="st">"initial_cluster"</span>,
                batch.by.var <span class="op">=</span> <span class="st">"Batch"</span><span class="op">)</span>
<span class="va">seu</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/finalClustering.html">finalClustering</a></span><span class="op">(</span><span class="va">seu</span>, <span class="va">ider</span>, cutree.h <span class="op">=</span> <span class="fl">0.45</span><span class="op">)</span></code></pre></div>
<p>A detailed tutorial of asCIDER is <a href="https://zhiyhu.github.io/CIDER/articles/asCIDER.html" class="external-link">here</a>. If your data do not have prior batch-specific clusters, the dnCDIER tutorials (<a href="https://zhiyhu.github.io/CIDER/articles/dnCIDER_highlevel.html" class="external-link">high-level</a> and <a href="https://zhiyhu.github.io/CIDER/articles/dnCIDER.html" class="external-link">detailed walk-through</a>) can be referred to.</p>
</div>
</div>
<div class="section level2">
<h2 id="quick-start---compute-the-similarity-matrix-within-one-batch">Quick start - compute the similarity matrix within one batch<a class="anchor" aria-label="anchor" href="#quick-start---compute-the-similarity-matrix-within-one-batch"></a>
</h2>
<p>Here is the code used to compute the similarity matrix within one batch.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zhiyhu/CIDER" class="external-link">CIDER</a></span><span class="op">)</span>
<span class="co"># make sure have a colume called "Batch" in the data and assign a uniform value</span>
<span class="co"># to all cells, for example:</span>
<span class="va">seu</span><span class="op">$</span><span class="va">Batch</span> <span class="op">&lt;-</span> <span class="st">"onebatch"</span> 
<span class="co"># run the getDistMat, the input needs to be list(seu), the tmp.initial.clusters </span>
<span class="co"># is the group information that you want to compute the similarity matrix with.</span>
<span class="co"># The output is the similarity matrix.</span>
<span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/getDistMat.html">getDistMat</a></span><span class="op">(</span>seu_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span>, tmp.initial.clusters <span class="op">=</span> <span class="st">"cell_type"</span><span class="op">)</span></code></pre></div>
<p>A more dedicated function is under construction.</p>
<!--- You'll still need to render `README.Rmd` regularly, to keep `README.md` up-to-date. `devtools::build_readme()` is handy for this. You could also use GitHub Actions to re-render `README.Rmd` every time you push. An example workflow can be found here: <https://github.com/r-lib/actions/tree/master/examples>.--->
</div>
<div class="section level2">
<h2 id="bug-reports-and-issues">Bug reports and issues<a class="anchor" aria-label="anchor" href="#bug-reports-and-issues"></a>
</h2>
<p>Please use <a href="https://github.com/zhiyhu/CIDER/issues" class="external-link">Issues</a> to report bugs or seek help. Thank you!</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Z. Hu, A. A. Ahmed, C. Yau. CIDER: an interpretable meta-clustering framework for single-cell RNA-seq data integration and evaluation. <em>Genome Biology</em> 22, Article number: 337 (2021); <a href="https://doi.org/10.1186/s13059-021-02561-2" class="external-link">doi: https://doi.org/10.1186/s13059-021-02561-2</a></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=CIDER" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/zhiyhu/CIDER/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/zhiyhu/CIDER/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing CIDER</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Zhiyuan Hu <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-1688-6032" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Christopher Yau <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-7615-8523" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Ahmed Ahmed <br><small class="roles"> Author </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://zenodo.org/badge/latestdoi/296897483" class="external-link"><img src="https://zenodo.org/badge/296897483.svg" alt="DOI"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Zhiyuan Hu, Christopher Yau, Ahmed Ahmed.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
